{
    "entities": {
        "UserProfile": {
            "title": "User Profile",
            "description": "Represents a user's public profile.",
            "type": "object",
            "properties": {
                "displayName": {
                    "type": "string",
                    "description": "The user's display name."
                },
                "photoURL": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL of the user's profile picture."
                },
                "email": {
                    "type": "string",
                    "format": "email",
                    "description": "The user's email address."
                },
                "role": {
                    "type": "string",
                    "description": "The user's role in the application.",
                    "enum": ["admin", "abonne", "createur", "moderateur", "agence"]
                },
                "signalPreKeyBundle": {
                    "type": "object",
                    "description": "The user's public pre-key bundle for the Signal Protocol."
                }
            },
            "required": ["displayName", "email", "role", "signalPreKeyBundle"]
        },
        "Conversation": {
            "title": "Conversation",
            "description": "Represents a chat conversation between two or more users.",
            "type": "object",
            "properties": {
                "participantIds": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "An array of user IDs participating in the conversation."
                },
                "lastMessage": {
                    "type": "string",
                    "description": "A snippet of the last message for preview purposes."
                },
                "updatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp of the last message."
                }
            },
            "required": ["participantIds", "updatedAt"]
        },
        "Message": {
            "title": "Message",
            "description": "Represents a single message within a conversation.",
            "type": "object",
            "properties": {
                "senderId": {
                    "type": "string",
                    "description": "The ID of the user who sent the message."
                },
                "text": {
                    "type": "string",
                    "description": "The content of the message. This may be encrypted."
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp when the message was sent."
                },
                "isPaid": {
                    "type": "boolean",
                    "description": "True if the message content is behind a paywall."
                },
                "contentTitle": {
                    "type": "string",
                    "description": "The title of the paid content."
                },
                "contentPrice": {
                    "type": "number",
                    "description": "The price of the paid content."
                },
                "contentImageUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "The URL of the image for the paid content."
                },
                "contentType": {
                    "type": "string",
                    "enum": ["video", "image", "audio", "text"],
                    "description": "The type of the paid content."
                }
            },
            "required": ["senderId", "createdAt"]
        },
        "ModerationAction": {
            "title": "Moderation Action",
            "description": "Represents a moderation action taken by an admin or moderator.",
            "type": "object",
            "properties": {
                "actionType": {
                    "type": "string",
                    "enum": ["contentApproved", "userBanned", "warningIssued", "contentRejected", "userMuted"]
                },
                "targetType": {
                    "type": "string",
                    "enum": ["user", "post"]
                },
                "targetId": {
                    "type": "string"
                },
                "moderatorId": {
                    "type": "string"
                },
                "timestamp": {
                    "type": "string",
                    "format": "date-time"
                },
                "reason": {
                    "type": "string"
                },
                "duration": {
                    "type": "number",
                    "description": "Duration in hours, if applicable (e.g., for mutes)."
                }
            },
            "required": ["actionType", "targetType", "targetId", "moderatorId", "timestamp"]
        }
    },
    "auth": {
        "providers": ["google.com", "password", "twitter.com", "apple.com"]
    },
    "firestore": {
        "/users/{userId}": {
            "schema": {
                "$ref": "#/backend/entities/UserProfile"
            },
            "description": "Stores public information for each user."
        },
        "/conversations/{conversationId}": {
            "schema": {
                "$ref": "#/backend/entities/Conversation"
            },
            "description": "Top-level collection to store chat conversations."
        },
        "/conversations/{conversationId}/messages/{messageId}": {
            "schema": {
                "$ref": "#/backend/entities/Message"
            },
            "description": "Sub-collection to store messages for a specific conversation."
        },
        "/moderation-actions/{actionId}": {
            "schema": {
                "$ref": "#/backend/entities/ModerationAction"
            },
            "description": "Stores a log of all moderation actions."
        }
    }
}
