{
    "entities": {
        "UserProfile": {
            "title": "User Profile",
            "description": "Represents a user's public profile.",
            "type": "object",
            "properties": {
                "displayName": {
                    "type": "string",
                    "description": "The user's display name."
                },
                "photoURL": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL of the user's profile picture."
                },
                "email": {
                    "type": "string",
                    "format": "email",
                    "description": "The user's email address."
                },
                "role": {
                    "type": "string",
                    "description": "The user's role in the application.",
                    "enum": ["admin", "abonne", "createur", "moderateur", "agence"]
                },
                "signalPreKeyBundle": {
                    "type": "object",
                    "description": "The user's public pre-key bundle for the Signal Protocol."
                },
                "bio": {
                    "type": "string",
                    "description": "A short bio for the creator."
                },
                "longBio": {
                    "type": "string",
                    "description": "A longer biography for the creator's profile page."
                },
                "category": {
                    "type": "string",
                    "description": "The category of the creator's content (e.g., Haute Couture, Culinary Arts)."
                },
                "bannerUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "URL for the creator's profile banner image."
                },
                "tiers": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "name": { "type": "string", "enum": ["Bronze", "Silver", "Gold"] },
                            "price": { "type": "number" },
                            "perks": { "type": "array", "items": { "type": "string" } },
                            "cta": { "type": "string" }
                        },
                        "required": ["name", "price", "perks", "cta"]
                    },
                    "description": "The subscription tiers offered by the creator."
                },
                "content": {
                     "type": "array",
                     "items": {
                         "type": "object",
                         "properties": {
                            "id": { "type": "string" },
                            "title": { "type": "string" },
                            "type": { "type": "string", "enum": ["image", "video", "article"] },
                            "imageUrl": { "type": "string", "format": "uri" },
                            "tier": { "type": "string", "enum": ["Bronze", "Silver", "Gold"] }
                         },
                         "required": ["id", "title", "type", "imageUrl", "tier"]
                     }
                },
                "subscriptions": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "A list of creator IDs the user is subscribed to."
                }
            },
            "required": ["displayName", "email", "role", "signalPreKeyBundle"]
        },
        "Conversation": {
            "title": "Conversation",
            "description": "Represents a chat conversation between two or more users.",
            "type": "object",
            "properties": {
                "participantIds": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "description": "An array of user IDs participating in the conversation."
                },
                "lastMessage": {
                    "type": "string",
                    "description": "A snippet of the last message for preview purposes."
                },
                "updatedAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp of the last message."
                }
            },
            "required": ["participantIds", "updatedAt"]
        },
        "Message": {
            "title": "Message",
            "description": "Represents a single message within a conversation.",
            "type": "object",
            "properties": {
                "senderId": {
                    "type": "string",
                    "description": "The ID of the user who sent the message."
                },
                "text": {
                    "type": "string",
                    "description": "The encrypted content of the message for the recipient."
                },
                "plaintext": {
                    "type": "string",
                    "description": "The unencrypted content of the message, only readable by the sender."
                },
                "createdAt": {
                    "type": "string",
                    "format": "date-time",
                    "description": "The timestamp when the message was sent."
                },
                "isPaid": {
                    "type": "boolean",
                    "description": "True if the message content is behind a paywall."
                },
                "contentTitle": {
                    "type": "string",
                    "description": "The title of the paid content."
                },
                "contentPrice": {
                    "type": "number",
                    "description": "The price of the paid content."
                },
                "contentImageUrl": {
                    "type": "string",
                    "format": "uri",
                    "description": "The URL of the image for the paid content."
                },
                "contentType": {
                    "type": "string",
                    "enum": ["video", "image", "audio", "text"],
                    "description": "The type of the paid content."
                }
            },
            "required": ["senderId", "text", "createdAt"]
        },
        "ModerationAction": {
            "title": "Moderation Action",
            "description": "Represents a moderation action taken by an admin or moderator.",
            "type": "object",
            "properties": {
                "actionType": {
                    "type": "string",
                    "enum": ["contentApproved", "userBanned", "warningIssued", "contentRejected", "userMuted"]
                },
                "targetType": {
                    "type": "string",
                    "enum": ["user", "post"]
                },
                "targetId": {
                    "type": "string"
                },
                "moderatorId": {
                    "type": "string"
                },
                "timestamp": {
                    "type": "string",
                    "format": "date-time"
                },
                "reason": {
                    "type": "string"
                },
                "duration": {
                    "type": "number",
                    "description": "Duration in hours, if applicable (e.g., for mutes)."
                }
            },
            "required": ["actionType", "targetType", "targetId", "moderatorId", "timestamp"]
        }
    },
    "auth": {
        "providers": ["google.com", "password", "twitter.com", "apple.com"]
    },
    "firestore": {
        "/users/{userId}": {
            "schema": {
                "$ref": "#/backend/entities/UserProfile"
            },
            "description": "Stores public information for each user."
        },
        "/conversations/{conversationId}": {
            "schema": {
                "$ref": "#/backend/entities/Conversation"
            },
            "description": "Top-level collection to store chat conversations."
        },
        "/conversations/{conversationId}/messages/{messageId}": {
            "schema": {
                "$ref": "#/backend/entities/Message"
            },
            "description": "Sub-collection to store messages for a specific conversation."
        },
        "/moderation-actions/{actionId}": {
            "schema": {
                "$ref": "#/backend/entities/ModerationAction"
            },
            "description": "Stores a log of all moderation actions."
        }
    }
}
